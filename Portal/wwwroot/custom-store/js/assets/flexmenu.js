!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(w){var e,i=w(window).width(),n=w(window).height(),l=[];w(window).on("resize",function(){clearTimeout(e),e=setTimeout(function(){w(window).width()===i&&w(window).height()===n||(w(l).each(function(){w(this).flexMenu({undo:!0}).flexMenu(this.options)}),i=w(window).width(),n=w(window).height())},200)}),w.fn.flexMenu=function(e){var i,v=w.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",shouldApply:function(){return!0},showOnHover:!0,popupAbsolute:!0,popupClass:"",undo:!1},e);return this.options=v,0<=(i=w.inArray(this,l))?l.splice(i,1):l.push(this),this.each(function(){var e,i,n,l,o,t,f=w(this),u=f.find("> li"),r=u.first(),d=u.last(),s=u.length,a=Math.floor(r.offset().top),p=Math.floor(r.outerHeight(!0)),h=!1;function c(e){return Math.ceil(e.offset().top)>=a+p}if(c(d)&&s>v.threshold&&!v.undo&&f.is(":visible")&&v.shouldApply()){var M=w('<ul class="flexMenu-popup"></ul>');for(M.addClass(v.popupClass),t=s;1<t;t--){if(i=c(e=f.find("> li:last-child")),t-1<=v.cutoff){w(f.children().get().reverse()).appendTo(M),h=!0;break}if(!i)break;e.appendTo(M)}h?f.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="#" title="'+v.linkTitleAll+'">'+v.linkTextAll+"</a></li>"):f.append('<li class="flexMenu-viewMore"><a href="#" title="'+v.linkTitle+'">'+v.linkText+"</a></li>"),c(n=f.find("> li.flexMenu-viewMore"))&&f.find("> li:nth-last-child(2)").appendTo(M),M.children().each(function(e,i){M.prepend(i)}),n.append(M),f.find("> li.flexMenu-viewMore > a").on("click",function(e){var i;i=n,w("li.flexMenu-viewMore.active").not(i).removeClass("active"),n.toggleClass("active"),e.preventDefault()}),v.showOnHover&&"undefined"!=typeof Modernizr&&!Modernizr.touch&&n.hover(function(){w(this).addClass("active")},function(){w(this).removeClass("active")})}else if(v.undo&&f.find("ul.flexMenu-popup")){for(l=(o=f.find("ul.flexMenu-popup")).find("li").length,t=1;t<=l;t++)o.find("> li:first-child").appendTo(f);o.remove(),f.find("> li.flexMenu-viewMore").remove()}})}});