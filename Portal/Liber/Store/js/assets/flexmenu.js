!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(M){var e,i=M(window).width(),n=M(window).height(),l=[];M(window).on("resize",function(){clearTimeout(e),e=setTimeout(function(){M(window).width()===i&&M(window).height()===n||(M(l).each(function(){M(this).flexMenu({undo:!0}).flexMenu(this.options)}),i=M(window).width(),n=M(window).height())},200)}),M.fn.flexMenu=function(e){var i,w=M.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",shouldApply:function(){return!0},showOnHover:!0,popupAbsolute:!0,popupClass:"",undo:!1},e);return this.options=w,0<=(i=M.inArray(this,l))?l.splice(i,1):l.push(this),this.each(function(){var e,i,n,l,o,t,f=M(this),u=f.find("> li"),s=u.first(),a=u.last(),r=u.length,d=Math.floor(s.offset().top),p=Math.floor(s.outerHeight(!0)),h=!1;function c(e){return Math.ceil(e.offset().top)>=d+p}if(c(a)&&r>w.threshold&&!w.undo&&f.is(":visible")&&w.shouldApply()){var v=M('<ul class="flexMenu-popup"></ul>');for(v.addClass(w.popupClass),t=r;1<t;t--){if(i=c(e=f.find("> li:last-child")),t-1<=w.cutoff){M(f.children().get().reverse()).appendTo(v),h=!0;break}if(!i)break;e.appendTo(v)}h?f.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="#" title="'+w.linkTitleAll+'">'+w.linkTextAll+"</a></li>"):f.append('<li class="flexMenu-viewMore"><a href="#" title="'+w.linkTitle+'">'+w.linkText+"</a></li>"),c(n=f.find("> li.flexMenu-viewMore"))&&f.find("> li:nth-last-child(2)").appendTo(v),v.children().each(function(e,i){v.prepend(i)}),n.append(v),f.find("> li.flexMenu-viewMore > a").on("click",function(e){var i;i=n,M("li.flexMenu-viewMore.active").not(i).removeClass("active"),n.toggleClass("active"),e.preventDefault()}),w.showOnHover&&n.on({mouseenter:function(){M(this).addClass("active")},mouseleave:function(){M(this).removeClass("active")}})}else if(w.undo&&f.find("ul.flexMenu-popup")){for(l=(o=f.find("ul.flexMenu-popup")).find("li").length,t=1;t<=l;t++)o.find("> li:first-child").appendTo(f);o.remove(),f.find("> li.flexMenu-viewMore").remove()}})}});